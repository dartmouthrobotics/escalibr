<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>escalibr: echo_sounder_camera_handler.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery.js"></script>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">echo_sounder_camera_handler.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="echo__sounder__camera__handler_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="echo__sounder__camera__handler_8h.html">escalibr/echo_sounder_camera_handler.h</a>&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;cv_bridge/cv_bridge.h&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;opencv2/opencv.hpp&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceescalibr.html">escalibr</a></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="structescalibr_1_1AppEllipse.html">   21</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structescalibr_1_1AppEllipse.html">AppEllipse</a></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="structescalibr_1_1AppEllipse.html#a71385aed49c7ecda8c7eb0003dae14cf">   23</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structescalibr_1_1AppEllipse.html#a71385aed49c7ecda8c7eb0003dae14cf">operator() </a>(cv::Point3f pt1, cv::Point3f pt2) {<span class="keywordflow">return</span> (pt1.z &lt; pt2.z);}</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<a class="code" href="namespaceescalibr.html#a2c69a1497df9f2adc8efc60f81dcd82c">appEllipse</a>;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="classescalibr_1_1EchoSounderCameraHandler.html#a31c1883f3879a5a1a8b705e9a11f83c9">   27</a></span>&#160;<a class="code" href="classescalibr_1_1EchoSounderCameraHandler.html#a31c1883f3879a5a1a8b705e9a11f83c9">EchoSounderCameraHandler::EchoSounderCameraHandler</a>(<span class="keywordtype">int</span> calibration_method, std::string camera_topic,</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  std::string echo_sounder_topic, <span class="keywordtype">float</span> min, <span class="keywordtype">float</span> max)</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  this-&gt;min_ = min;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  this-&gt;max_ = max;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  this-&gt;range_ = 0.1;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  this-&gt;prev_structure_detected_ = <span class="keyword">false</span>;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  this-&gt;counter_ = 0;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;in camera handler&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  this-&gt;img_sub_.subscribe(nh_, camera_topic, 1);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  this-&gt;echo_sounder_sub_.subscribe(nh_, echo_sounder_topic, 1);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  this-&gt;sync_.reset(<span class="keyword">new</span> <a class="code" href="classescalibr_1_1EchoSounderCameraHandler.html#a29e82ab94155a11ce9867d9a063349e2">Sync</a>(<a class="code" href="classescalibr_1_1EchoSounderCameraHandler.html#ac6d4b7b011ffd73ecd2666d69928f781">SyncPolicy</a>(1), this-&gt;img_sub_, this-&gt;echo_sounder_sub_));</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">if</span> (0 == calibration_method)</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;SUPER COARSE CALIBRATION&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    this-&gt;sync_-&gt;registerCallback(boost::bind(&amp;<a class="code" href="classescalibr_1_1EchoSounderCameraHandler.html#a0c9c066072d8e68fb70a401f885a601e">EchoSounderCameraHandler::coarseCallback</a>, <span class="keyword">this</span>, _1, _2));</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// std::string path = ros::package::getPath(&quot;underwater_color_enhance&quot;) + &quot;/ros_config.yaml&quot;;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    this-&gt;prev_image_ = cv::imread(<span class="stringliteral">&quot;/home/darobot/Research/escalibr/catkin_ws/src/escalibr/circle.png&quot;</span>);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">// Callback to implement the super coarse calibration using the camera and echo sounder data</span></div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classescalibr_1_1EchoSounderCameraHandler.html#a0c9c066072d8e68fb70a401f885a601e">   55</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classescalibr_1_1EchoSounderCameraHandler.html#a0c9c066072d8e68fb70a401f885a601e">EchoSounderCameraHandler::coarseCallback</a>(<span class="keyword">const</span> sensor_msgs::ImageConstPtr&amp; img_msg,</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keyword">const</span> ping_nodelet::Ping::ConstPtr&amp; echo_sounder_msg)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;{</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// Convert ROS sensor image message to CV Mat image</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  cv_bridge::CvImagePtr cv_ptr;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordflow">try</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    cv_ptr = cv_bridge::toCvCopy(img_msg, sensor_msgs::image_encodings::BGR8);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  }</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">catch</span>(cv_bridge::Exception&amp; e)</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    ROS_ERROR(<span class="stringliteral">&quot;cv_bridge exception: %s&quot;</span>, e.what());</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// Detect edge point</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">// If no structure detected now and structure was detected beforehand</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// Also, structure must have been detected for at least set amount of rounds</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">if</span> (this-&gt;FINAL_HOLD_COUNT_ &lt;= this-&gt;counter_ &amp;&amp; this-&gt;max_ &lt; echo_sounder_msg-&gt;distance</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    &amp;&amp; this-&gt;prev_structure_detected_)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// Locate edge point and store its 2D pixel coordiante with its image depth measurement</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    detectEdgePoint(echo_sounder_msg-&gt;distance);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// TO DO: show images with the detected points in red</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// cv::Point center(cvRound(circles[i][0]), cvRound(circles[i][1]));</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// cv::circle(this-&gt;prev_image, center, 3, cv::Scalar(0,255,0), -1, 8, 0);</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// Check for ellipse</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">int</span> pointer = checkEllipse();</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">if</span> (-1 != pointer)  <span class="comment">// There is enough data to fit an ellipse</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;NEW ELLIPSE&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="comment">// Fit an ellipse and then save the data to a vector</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      fitEllipse(pointer);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="comment">// Two ellipses are enough to get params for echo sounder</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="keywordflow">if</span> (2 == this-&gt;ellipse_data_.size())</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        std::vector&lt;float&gt; result = getEchoSounderTf();</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="comment">// Save ellipse data</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        saveResult(result);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        exit(EXIT_SUCCESS);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">else</span>  <span class="comment">// Need one more ellipse</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="comment">// Reset</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        this-&gt;prev_structure_detected_ = <span class="keyword">false</span>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">// Structure detected</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this-&gt;min_ &lt; echo_sounder_msg-&gt;distance &lt; this-&gt;max_)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// Begin counter for the structure to be detected for a period</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;prev_structure_detected_)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      this-&gt;prev_structure_detected_ = <span class="keyword">true</span>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;STRUCTURE DETECTED: please hold&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      this-&gt;counter_ = 0;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="comment">// Hold complete</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">if</span> (this-&gt;FINAL_HOLD_COUNT_ &gt;= this-&gt;counter_)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;FINISHED HOLD: move structue out of bounds&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="comment">// Continue to hold</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;CONTINUE TO HOLD&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        this-&gt;counter_++;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// Save image for potential edge point detection</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    this-&gt;prev_image_ = cv_ptr-&gt;image;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">// No structure detected</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;NO DETECTION&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    this-&gt;counter_ = 0;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classescalibr_1_1EchoSounderCameraHandler.html#a6bd95a6d1e629895d40933c445c1fb5a">  147</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classescalibr_1_1EchoSounderCameraHandler.html#a6bd95a6d1e629895d40933c445c1fb5a">EchoSounderCameraHandler::detectEdgePoint</a>(<span class="keywordtype">float</span> distance)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;{</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">// Structure is a sphere</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  cv::Mat gray_image;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  cv::cvtColor(this-&gt;prev_image_, gray_image, CV_BGR2GRAY);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">// CHECK if this needed</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// Reduce noise to avoid false circle detection</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  cv::GaussianBlur(gray_image, gray_image, cv::Size(9, 9), 2, 2);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// Detect circles in the grayscale image</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  std::vector&lt;cv::Vec3f&gt; circles;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  cv::HoughCircles(gray_image, circles, CV_HOUGH_GRADIENT, 1, gray_image.rows/8, 200, 100, 0, 0);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">if</span> (1 == circles.size())  <span class="comment">// Sphere structure detected in image</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;NEW EDGE POINT&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;depth: &quot;</span> &lt;&lt; distance &lt;&lt; <span class="stringliteral">&quot;\tx: &quot;</span> &lt;&lt; circles[0][0] &lt;&lt; <span class="stringliteral">&quot;\ty: &quot;</span> &lt;&lt; circles[0][1] &lt;&lt; std::endl;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    cv::Point3f new_edge_point(circles[0][1], circles[0][1], distance);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    this-&gt;edge_point_data_.push_back(new_edge_point);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">else</span>  <span class="comment">// No structure detected in image</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;ERROR: too many &#39;circles&#39; in the image&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="classescalibr_1_1EchoSounderCameraHandler.html#a236d950100902ebb9f35453005efe9f3">  176</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classescalibr_1_1EchoSounderCameraHandler.html#a236d950100902ebb9f35453005efe9f3">EchoSounderCameraHandler::checkEllipse</a>()</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;{</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// Check if there are enough data points</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">if</span> (this-&gt;ELLIPSE_SAMPLE_SIZE_ &gt; this-&gt;edge_point_data_.size())</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="comment">// Sort vector by increasing depth measurement</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  std::sort(this-&gt;edge_point_data_.begin(), this-&gt;edge_point_data_.end(), <a class="code" href="namespaceescalibr.html#a2c69a1497df9f2adc8efc60f81dcd82c">appEllipse</a>);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// Check if the data points exists within an acceptable depth range</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i + 0 &lt; this-&gt;edge_point_data_.size(); i++)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">float</span> diff = this-&gt;edge_point_data_[i+this-&gt;ELLIPSE_SAMPLE_SIZE_-1].z - this-&gt;edge_point_data_[i].z;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">if</span> (diff &lt; this-&gt;range_)</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="comment">// Return pointer to where the set of data points start</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordflow">return</span> i;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">// TO DO: more comments explaining algorithm</span></div><div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="classescalibr_1_1EchoSounderCameraHandler.html#ac7a8a8bbb025796a0cf53273755a0db8">  203</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classescalibr_1_1EchoSounderCameraHandler.html#ac7a8a8bbb025796a0cf53273755a0db8">EchoSounderCameraHandler::fitEllipse</a>(<span class="keywordtype">int</span> pt)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;{</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordtype">float</span> TOLERANCE = 0.2;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordtype">int</span> DIM = 2;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  Eigen::MatrixXf data_points(DIM, this-&gt;ELLIPSE_SAMPLE_SIZE_);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  data_points &lt;&lt; this-&gt;edge_point_data_[pt].x, this-&gt;edge_point_data_[pt+1].x,</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                      this-&gt;edge_point_data_[pt+2].x, this-&gt;edge_point_data_[pt+3].x,</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                      this-&gt;edge_point_data_[pt+4].x, this-&gt;edge_point_data_[pt+5].x,</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                      this-&gt;edge_point_data_[pt+6].x, this-&gt;edge_point_data_[pt+7].x,</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                      this-&gt;edge_point_data_[pt+8].x, this-&gt;edge_point_data_[pt+9].x,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                 this-&gt;edge_point_data_[pt].y, this-&gt;edge_point_data_[pt+1].y,</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                      this-&gt;edge_point_data_[pt+2].y, this-&gt;edge_point_data_[pt+3].y,</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                      this-&gt;edge_point_data_[pt+4].y, this-&gt;edge_point_data_[pt+5].y,</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                      this-&gt;edge_point_data_[pt+6].y, this-&gt;edge_point_data_[pt+7].y,</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                      this-&gt;edge_point_data_[pt+8].y, this-&gt;edge_point_data_[pt+9].y;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">// Test purposes</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// data_points &lt;&lt; 5.0, 7.0, 10.0, 0.0,  5.0,  9.0,  1.0, 9.5,  4.0,  4.0,</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">//        4.5, 5.0, 10.0, 10.0, 14.0, 14.0, 4.0, 13.5, 14.0, 4.0;</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  Eigen::MatrixXf q = data_points;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  q.conservativeResize(data_points.rows() + 1, data_points.cols());</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; q.cols(); i++)</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    q(q.rows() - 1, i) = 1;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordtype">int</span> count = 1;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordtype">double</span> err = 1;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> init_u = 1.0 / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(this-&gt;ELLIPSE_SAMPLE_SIZE_);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  Eigen::MatrixXf u = Eigen::MatrixXf::Constant(this-&gt;ELLIPSE_SAMPLE_SIZE_, 1, init_u);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordflow">while</span> (err &gt; TOLERANCE)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// Eigen::MatrixXf Q_tr = q.transpose();</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    Eigen::MatrixXf X = q * u.asDiagonal() * q.transpose();</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    Eigen::MatrixXf M = (q.transpose() * X.inverse() * q).diagonal();</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">int</span> j_x, j_y;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">double</span> maximum = M.maxCoeff(&amp;j_x, &amp;j_y);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">double</span> step_size = (maximum - DIM - 1) / ((DIM + 1) * (maximum + 1));</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    Eigen::MatrixXf new_u = (1 - step_size) * u;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    new_u(j_x, 0) += step_size;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// Find error</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    Eigen::MatrixXf u_diff = new_u - u;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; u_diff.rows(); i++)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    {</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; u_diff.cols(); j++)</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        u_diff(i, j) *= u_diff(i, j);  <span class="comment">// Square each element of the matrix</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      err = sqrt(u_diff.sum());</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      count++;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      u = new_u;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordtype">float</span> avg_depth = 0.0;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = pt; i &lt; pt + this-&gt;ELLIPSE_SAMPLE_SIZE_; i++)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      avg_depth += this-&gt;edge_point_data_[i].z;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    avg_depth /= this-&gt;ELLIPSE_SAMPLE_SIZE_;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    Eigen::MatrixXf center = data_points * u;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;center: &quot;</span> &lt;&lt; center &lt;&lt; std::endl;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    Eigen::Vector3f new_ellipse_data {center(0, 0), center(1, 0), avg_depth};</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    this-&gt;ellipse_data_.push_back(new_ellipse_data);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="classescalibr_1_1EchoSounderCameraHandler.html#a0b91c898adb7e83fa447339e5ae25027">  280</a></span>&#160;std::vector&lt;float&gt; <a class="code" href="classescalibr_1_1EchoSounderCameraHandler.html#a0b91c898adb7e83fa447339e5ae25027">EchoSounderCameraHandler::getEchoSounderTf</a>()</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;{</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// Subtract data points and normalize</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  Eigen::Vector3f unit;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">if</span> (this-&gt;ellipse_data_[0][2] &lt; this-&gt;ellipse_data_[1][2])</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    unit = (this-&gt;ellipse_data_[1] - this-&gt;ellipse_data_[0]).normalized();</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    unit = (this-&gt;ellipse_data_[0] - this-&gt;ellipse_data_[1]).normalized();</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">// X, Y, Z</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  Eigen::Vector3f pose = this-&gt;ellipse_data_[0] - 2 * unit;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// Yaw</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordtype">float</span> yaw = atan2(pose[0], -pose[1]);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">// Pitch</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordtype">float</span> pitch = atan2(sqrt(pow(pose[0], 2) + pow(pose[1], 2)), pose[2]);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  std::vector&lt;float&gt; final_parameters = {pose[0], pose[1], pose[2], pitch, yaw};</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">return</span> final_parameters;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;}</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="classescalibr_1_1EchoSounderCameraHandler.html#acbbae0f654254a6848bba1d1eb39c3ce">  308</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classescalibr_1_1EchoSounderCameraHandler.html#acbbae0f654254a6848bba1d1eb39c3ce">EchoSounderCameraHandler::saveResult</a>(std::vector&lt;float&gt; result)</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;{</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="comment">// TO DO: save to a yaml file as well</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;x: &quot;</span> &lt;&lt; result[0] &lt;&lt; std::endl;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;y: &quot;</span> &lt;&lt; result[1] &lt;&lt; std::endl;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;x: &quot;</span> &lt;&lt; result[2] &lt;&lt; std::endl;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;pitch: &quot;</span> &lt;&lt; result[3] &lt;&lt; std::endl;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;yaw: &quot;</span> &lt;&lt; result[4] &lt;&lt; std::endl;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;}</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}  <span class="comment">// namespace escalibr</span></div><div class="ttc" id="classescalibr_1_1EchoSounderCameraHandler_html_a31c1883f3879a5a1a8b705e9a11f83c9"><div class="ttname"><a href="classescalibr_1_1EchoSounderCameraHandler.html#a31c1883f3879a5a1a8b705e9a11f83c9">escalibr::EchoSounderCameraHandler::EchoSounderCameraHandler</a></div><div class="ttdeci">EchoSounderCameraHandler(int calibration_method, std::string camera_topic, std::string echo_sounder_topic, float min, float max)</div><div class="ttdef"><b>Definition:</b> <a href="echo__sounder__camera__handler_8cpp_source.html#l00027">echo_sounder_camera_handler.cpp:27</a></div></div>
<div class="ttc" id="classescalibr_1_1EchoSounderCameraHandler_html_ac7a8a8bbb025796a0cf53273755a0db8"><div class="ttname"><a href="classescalibr_1_1EchoSounderCameraHandler.html#ac7a8a8bbb025796a0cf53273755a0db8">escalibr::EchoSounderCameraHandler::fitEllipse</a></div><div class="ttdeci">void fitEllipse(int pointer)</div><div class="ttdef"><b>Definition:</b> <a href="echo__sounder__camera__handler_8cpp_source.html#l00203">echo_sounder_camera_handler.cpp:203</a></div></div>
<div class="ttc" id="classescalibr_1_1EchoSounderCameraHandler_html_ac6d4b7b011ffd73ecd2666d69928f781"><div class="ttname"><a href="classescalibr_1_1EchoSounderCameraHandler.html#ac6d4b7b011ffd73ecd2666d69928f781">escalibr::EchoSounderCameraHandler::SyncPolicy</a></div><div class="ttdeci">message_filters::sync_policies::ApproximateTime&lt; sensor_msgs::Image, ping_nodelet::Ping &gt; SyncPolicy</div><div class="ttdef"><b>Definition:</b> <a href="echo__sounder__camera__handler_8h_source.html#l00052">echo_sounder_camera_handler.h:52</a></div></div>
<div class="ttc" id="structescalibr_1_1AppEllipse_html"><div class="ttname"><a href="structescalibr_1_1AppEllipse.html">escalibr::AppEllipse</a></div><div class="ttdef"><b>Definition:</b> <a href="echo__sounder__camera__handler_8cpp_source.html#l00021">echo_sounder_camera_handler.cpp:21</a></div></div>
<div class="ttc" id="namespaceescalibr_html_a2c69a1497df9f2adc8efc60f81dcd82c"><div class="ttname"><a href="namespaceescalibr.html#a2c69a1497df9f2adc8efc60f81dcd82c">escalibr::appEllipse</a></div><div class="ttdeci">struct escalibr::AppEllipse appEllipse</div></div>
<div class="ttc" id="namespaceescalibr_html"><div class="ttname"><a href="namespaceescalibr.html">escalibr</a></div><div class="ttdef"><b>Definition:</b> <a href="echo__sounder__camera__handler_8h_source.html#l00024">echo_sounder_camera_handler.h:24</a></div></div>
<div class="ttc" id="classescalibr_1_1EchoSounderCameraHandler_html_a6bd95a6d1e629895d40933c445c1fb5a"><div class="ttname"><a href="classescalibr_1_1EchoSounderCameraHandler.html#a6bd95a6d1e629895d40933c445c1fb5a">escalibr::EchoSounderCameraHandler::detectEdgePoint</a></div><div class="ttdeci">void detectEdgePoint(float distance)</div><div class="ttdef"><b>Definition:</b> <a href="echo__sounder__camera__handler_8cpp_source.html#l00147">echo_sounder_camera_handler.cpp:147</a></div></div>
<div class="ttc" id="classescalibr_1_1EchoSounderCameraHandler_html_acbbae0f654254a6848bba1d1eb39c3ce"><div class="ttname"><a href="classescalibr_1_1EchoSounderCameraHandler.html#acbbae0f654254a6848bba1d1eb39c3ce">escalibr::EchoSounderCameraHandler::saveResult</a></div><div class="ttdeci">void saveResult(std::vector&lt; float &gt; result)</div><div class="ttdef"><b>Definition:</b> <a href="echo__sounder__camera__handler_8cpp_source.html#l00308">echo_sounder_camera_handler.cpp:308</a></div></div>
<div class="ttc" id="classescalibr_1_1EchoSounderCameraHandler_html_a29e82ab94155a11ce9867d9a063349e2"><div class="ttname"><a href="classescalibr_1_1EchoSounderCameraHandler.html#a29e82ab94155a11ce9867d9a063349e2">escalibr::EchoSounderCameraHandler::Sync</a></div><div class="ttdeci">message_filters::Synchronizer&lt; SyncPolicy &gt; Sync</div><div class="ttdef"><b>Definition:</b> <a href="echo__sounder__camera__handler_8h_source.html#l00053">echo_sounder_camera_handler.h:53</a></div></div>
<div class="ttc" id="classescalibr_1_1EchoSounderCameraHandler_html_a236d950100902ebb9f35453005efe9f3"><div class="ttname"><a href="classescalibr_1_1EchoSounderCameraHandler.html#a236d950100902ebb9f35453005efe9f3">escalibr::EchoSounderCameraHandler::checkEllipse</a></div><div class="ttdeci">int checkEllipse()</div><div class="ttdef"><b>Definition:</b> <a href="echo__sounder__camera__handler_8cpp_source.html#l00176">echo_sounder_camera_handler.cpp:176</a></div></div>
<div class="ttc" id="classescalibr_1_1EchoSounderCameraHandler_html_a0b91c898adb7e83fa447339e5ae25027"><div class="ttname"><a href="classescalibr_1_1EchoSounderCameraHandler.html#a0b91c898adb7e83fa447339e5ae25027">escalibr::EchoSounderCameraHandler::getEchoSounderTf</a></div><div class="ttdeci">std::vector&lt; float &gt; getEchoSounderTf()</div><div class="ttdef"><b>Definition:</b> <a href="echo__sounder__camera__handler_8cpp_source.html#l00280">echo_sounder_camera_handler.cpp:280</a></div></div>
<div class="ttc" id="echo__sounder__camera__handler_8h_html"><div class="ttname"><a href="echo__sounder__camera__handler_8h.html">echo_sounder_camera_handler.h</a></div></div>
<div class="ttc" id="structescalibr_1_1AppEllipse_html_a71385aed49c7ecda8c7eb0003dae14cf"><div class="ttname"><a href="structescalibr_1_1AppEllipse.html#a71385aed49c7ecda8c7eb0003dae14cf">escalibr::AppEllipse::operator()</a></div><div class="ttdeci">bool operator()(cv::Point3f pt1, cv::Point3f pt2)</div><div class="ttdef"><b>Definition:</b> <a href="echo__sounder__camera__handler_8cpp_source.html#l00023">echo_sounder_camera_handler.cpp:23</a></div></div>
<div class="ttc" id="classescalibr_1_1EchoSounderCameraHandler_html_a0c9c066072d8e68fb70a401f885a601e"><div class="ttname"><a href="classescalibr_1_1EchoSounderCameraHandler.html#a0c9c066072d8e68fb70a401f885a601e">escalibr::EchoSounderCameraHandler::coarseCallback</a></div><div class="ttdeci">void coarseCallback(const sensor_msgs::ImageConstPtr &amp;img_msg, const ping_nodelet::Ping::ConstPtr &amp;echo_sounder_msg)</div><div class="ttdef"><b>Definition:</b> <a href="echo__sounder__camera__handler_8cpp_source.html#l00055">echo_sounder_camera_handler.cpp:55</a></div></div>
</div><!-- fragment --></div><!-- contents -->

<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://wiki.ros.org/escalibr">escalibr</a><br />
Author(s): Monika Roznere <mroznere@gmail.com></br />
<small>autogenerated on Mon Aug 19 2019 18:35:32</small>
</div>
</body>
</html>
